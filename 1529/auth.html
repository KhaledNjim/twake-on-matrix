<!DOCTYPE html>
<title>Authentication complete</title>
<p>Authentication is complete. If this page does not navigate automatically, please <a href="#" id="manualRedirectLink">click here</a> to continue.</p>
<script>
  function postAuthenticationMessage() {
    const urlParams = new URLSearchParams(window.location.search);
    const loginToken = urlParams.get('loginToken');
    const homeserver = urlParams.get('homeserver');
    let urlWithoutQueryParams = window.location.protocol + "//" + window.location.host + window.location.pathname;
    const redirectUrl = urlWithoutQueryParams + '/#/onAuthRedirect';
    if (loginToken === null) {
      updateManualRedirectLink(redirectUrl);
      window.location.href = redirectUrl;
      return;
    }
    const finalRedirectUrl = redirectUrl + '/?loginToken=' + loginToken + '&homeserver=' + homeserver;
    updateManualRedirectLink(finalRedirectUrl);
    window.location.href = finalRedirectUrl;
  }

  function updateManualRedirectLink(url) {
    document.getElementById('manualRedirectLink').href = url;
  }

  postAuthenticationMessage();
</script>