<!DOCTYPE html>
<title>Authentication complete</title>
<p>Authentication is complete. If this page does not navigate automatically, please <a href="#" id="manualRedirectLink">click here</a> to continue.</p>
<script>
  function postAuthenticationMessage() {
    const urlParams = new URLSearchParams(window.location.search);
    const loginToken = urlParams.get('loginToken');
    const homeserver = urlParams.get('homeserver');
    var redirectUrl = window.location.href.replace('/auth.html', '/#/onAuthRedirect');
    redirectUrl = redirectUrl.replace('/web', '');
    if (loginToken === null) {
      updateManualRedirectLink(redirectUrl);
      window.location.href = redirectUrl;
      return;
    }
    updateManualRedirectLink(redirectUrl);
    window.location.href = redirectUrl;
  }

  function updateManualRedirectLink(url) {
    document.getElementById('manualRedirectLink').href = url;
  }

  postAuthenticationMessage();
</script>